@{
    ViewData["Title"] = "HRO-SMA";
}

@model WeatherUpdateViewModel


    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.50.0/mapbox-gl.css' rel='stylesheet' />
    <h1>Smart things weerstation server.</h1>
    <div class="alert alert-info">Deze website is op dit moment nog onder constructie. Meld fouten op <a href="https://github.com/hro-sma/weather-station-server">onze Github</a> </div>

    <div id="weathermap">
        <div id='map'></div>
    </div>


    <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiaDQwOTk5NzkiLCJhIjoiY2pueDVybHk1MG56YjNwcnpjcjc2cThhaCJ9.DDkVVzYzBw-1SA2o6hkXug';

    var updates = @Model.LatestUpdates;

    var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v9',
        center: [5, 52],
        zoom: 7
    });

    @{
        foreach (var test in Model.LatestUpdates)
        {
            <text>

    // create the popup
    var popup = new mapboxgl.Popup({ offset: 25 })
        .setText(@test.Device.DeviceName +
            " " +
            @test.TemperatureC +
            " " +
            @test.Windspeed +
            " " +
            @test.Humidity +
            " " +
            @test.Windspeed);

    new mapboxgl.Marker(el)
        .setLngLat([@test.Device.Longitude, @test.Device.Latitude])
        .setPopup(popup) // sets a popup on this marker
        .addTo(map);


            </text>
        }
    }
    </script>


    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.50.0/mapbox-gl.js'></script>